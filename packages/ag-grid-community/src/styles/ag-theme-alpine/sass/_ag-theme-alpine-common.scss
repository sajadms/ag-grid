@import '../../ag-theme-base/sass/ag-theme-base';
@import './ag-theme-alpine-mixins';

@mixin ag-theme-alpine($params) {
    @include ag-grid-theme($params);
    .ag-cell,
    .ag-header-cell,
    .ag-header-group-cell {
        box-sizing: border-box;
    }

    .ag-root-wrapper {
        border: 1px solid $chrome-border-color;
        border-radius: $border-radius;
    }

    .ag-column-drop {
        border-bottom: 1px solid $chrome-border-color;
    }

    .ag-root {
    }

    .ag-header {
        border-bottom: 1px solid $chrome-border-color;
    }
    .ag-header-cell {
        border-color: $chrome-border-color;
    }

    .ag-ltr .ag-header-cell,
    .ag-ltr .ag-header-group-cell {
        border-right: 1px solid $chrome-border-color;
    }

    .ag-ltr .ag-cell {
        border-right: 1px solid $border-color;
    }

    .ag-row:not(.ag-row-selected) .ag-cell.ag-column-hover {
        background-color: transparentize($active, 0.97);
    }

    ////////////////////////////////////////
    // filter menu
    ////////////////////////////////////////
    .ag-filter {
        .ag-filter-body-wrapper {
            padding: $grid-size * 2;
            .ag-filter-select,
            .ag-filter-body,
            .ag-filter-filter {
                margin: 0;
            }

            .ag-filter-select,
            .ag-filter-body,
            .ag-filter-condition {
                &:not(:last-child) {
                    margin-bottom: $grid-size * 2;
                }
            }

            .ag-filter-filter {
                @extend %input-text;
            }

            .ag-filter-select {
                @extend %select;
            }

            .ag-input-wrapper {
                overflow: visible;
            }
        }

        .ag-filter-apply-panel {
            padding: 0;
            padding-top: $grid-size * 3;
            margin: $grid-size * 2;
            margin-top: 0;
            border-top: 1px solid $border-color;

            button {
                @extend %button;
            }

            button[ref='eClearButton'] {
                @extend %reset-button;
            }
        }

        .ag-filter-condition input[type='radio'] {
            @extend %radio-button;
        }

        .ag-filter-condition label {
            @extend %label;
            margin-right: $grid-size;
        }

        .ag-native-checkbox {
            @include checkbox($active);
        }
    }

    .ag-filter-header-container {
        margin-bottom: $grid-size;
        .ag-set-filter-item {
            margin-top: $grid-size;
            margin-bottom: $grid-size;
        }
    }
    ////////////////////////////////////////
    // context menu and enterprise column menu
    ////////////////////////////////////////
    .ag-menu {
        background: $alpine-gray-5;

        .ag-menu-list {
            margin: 0;
        }
    }

    .ag-menu-list {
        font: $chrome-font-weight $chrome-font-size $chrome-font-family;
        padding: $grid-size * 2;
        margin: 0;

        .ag-menu-option > span {
            padding-top: $grid-size;
            padding-bottom: $grid-size;
        }

        .ag-menu-option-shortcut {
            text-align: right;
            font-size: 0.7rem;
            vertical-align: super;
            opacity: 0.7;
        }
    }

    .ag-tab-header {
        border-bottom: 1px solid $chrome-border-color;

        .ag-tab {
            padding: $grid-size $grid-size * 2;

            .ag-icon {
                margin-left: $grid-size;
                display: block;
            }
        }

        .ag-tab-selected {
            .ag-icon {
                color: $active;
            }
        }

        .ag-tab::after {
            content: ' ';
            width: $grid-size * 3;
            height: 0px;
            border-top-left-radius: 3px;
            border-top-right-radius: 3px;
            border: 1px solid $chrome-border-color;
            border-bottom-color: $alpine-gray-5;
            background: $alpine-gray-5;
            position: relative;
            left: -($grid-size * 3 - 1);
            bottom: -$grid-size * 3 - 1;
            display: block;
            transition: all 0.1s linear;
        }
        .ag-tab-selected::after {
            opacity: 1;
            height: 6px;
        }
    }

    // resets from the main theme
    .ag-tab-body {
        border-top: 1px solid $border-color;
        padding: 0;

        .ag-menu-list {
            & > div:first-child > span {
                padding-top: $grid-size;
            }
            & > div:last-child > span {
                padding-bottom: $grid-size;
            }
        }
    }

    ////////////////////////////////////////
    // Popup
    ////////////////////////////////////////
    &.ag-popup > div:not(.ag-tooltip-custom) {
        border: 1px solid $chrome-border-color;
        border-radius: $border-radius;
        box-shadow: 0 0 2px 0.1rem transparentize($alpine-gray-4, 0.6);
    }

    &.ag-dnd-ghost {
        box-shadow: 0 0 2px 0.1rem transparentize($alpine-gray-4, 0.6);
        border-radius: $border-radius;
    }

    ////////////////////////////////////////
    // Selection Checkbox
    ////////////////////////////////////////
    .ag-selection-checkbox input {
        @include checkbox;
    }

    ////////////////////////////////////////
    // Header Checkbox
    ////////////////////////////////////////
    .ag-checkbox {
        .ag-input-wrapper {
            overflow: visible;
        }

        input {
            @include checkbox;
        }
    }

    ////////////////////////////////////////
    // Header Checkbox
    ////////////////////////////////////////
    &.ag-popup .ag-tooltip {
        font-size: $tooltip-font-size;
        padding: $grid-size / 2 $grid-size;
    }

    ////////////////////////////////////////
    // Column Resize Handle
    ////////////////////////////////////////
    $resize-handle-color: transparentize($chrome-border-color, 0);
    .ag-header-cell-resize {
        box-sizing: border-box;
        right: -2px;
        width: $grid-size;

        &::before {
            content: ' ';
            border-right: 1px solid $resize-handle-color;
            width: 2px;
            height: $header-height / 4;
            margin-top: $header-height * 3 / 2 / 4;
            display: block;
            transform: translateX($grid-size / 2 - 1);
        }
    }

    ////////////////////////////////////////
    // Pinned Containers
    ////////////////////////////////////////
    .ag-pinned-left-header,
    .ag-root:not(.ag-has-focus) .ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right) {
        border-right: 1px solid $chrome-border-color !important;
    }

    .ag-pinned-right-header {
        border-left-color: $chrome-border-color;
    }

    .ag-ltr .ag-pinned-right-header .ag-header-cell-resize {
        left: -1px;
    }

    .ag-ltr .ag-root:not(.ag-has-focus) .ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left) {
        border-left-color: $chrome-border-color;
    }

    ////////////////////////////////////////
    // Floating Filter
    ////////////////////////////////////////
    .ag-input-wrapper input:not([type]) {
        @extend %input-text;
        border-color: $form-element-border-color;
        font-size: smaller;
    }

    .ag-floating-filter-body {
        .ag-input-wrapper {
            overflow: visible;
        }
    }

    .ag-floating-filter-button {
        button {
            @include with-dropdown-arrow();
            @extend %button;
            background-position: right $grid-size / 2 top $grid-size / 2;
            padding: $grid-size - 1;
            padding-left: $grid-size - 1;
            height: $icon-size + $grid-size * 2 - 2;
            width: $icon-size + $grid-size * 5;
            border-radius: $border-radius;
            border: 1px solid $form-element-border-color;
            text-align: left;

            .ag-icon {
                color: $form-element-border-color;
            }

            &:active .ag-icon {
                color: $alpine-white;
            }
        }
    }

    ////////////////////////////////////////
    // Navigation
    ////////////////////////////////////////
    .ag-ltr,
    .ag-rtl {
        .ag-has-focus .ag-cell-focus:not(.ag-cell-range-selected),
        .ag-has-focus .ag-cell-focus.ag-cell-range-single-cell,
        .ag-cell-focus.ag-cell-range-single-cell.ag-cell-range-handle {
            border: 1px solid $active;
        }
    }

    .ag-cell.ag-cell-inline-editing {
        box-shadow: 0 0 2px 0.1rem transparentize($active, 0.6);
        border-radius: 0;
        padding: 0;
        height: 100%;
        overflow: visible;

        // text editor
        .ag-input-wrapper .ag-cell-edit-input {
            @extend %input-text;
            border: 0;
            border-radius: 0;
            padding-left: $grid-size * 3 - 1;
            font: $font-weight $font-size $font-family;
        }
        // select editor
        .ag-cell-edit-input select {
            @extend %select;
            border: 0;
            border-radius: 0;
            padding-left: $grid-size * 3 - 1;
            background-position: right $grid-size top $row-height / 2 - 9;
            font: $font-weight $font-size $font-family;
        }
    }

    ////////////////////////////////////////
    // Popup editing
    ////////////////////////////////////////
    .ag-popup > div.ag-popup-editor {
        min-height: $row-height;
        box-shadow: 0 0 2px 0.1rem transparentize($active, 0.6);
        border-color: $active;
        border-radius: 0;
        padding: 0;
        overflow: visible;
        box-sizing: border-box;

        // text editor
        .ag-input-wrapper .ag-cell-edit-input,
        .ag-cell-edit-input select {
            border: 0;
            border-radius: 0;
            padding-left: $grid-size * 3 - 1;
            padding-right: $grid-size * 6 - 1;
            font: $font-weight $font-size $font-family;
            line-height: $row-height - $grid-size * 2 - 2;
        }

        .ag-input-wrapper .ag-cell-edit-input {
            @extend %input-text;
        }

        // select editor
        .ag-cell-edit-input select {
            @extend %select;
            background-position: right $grid-size top $row-height / 2 - 9;
        }

        textarea {
            @extend %custom-selection;
            border: 0;
            font: $font-weight $font-size $font-family;
            padding: $grid-size * 2 $grid-size * 3;
        }
    }

    ////////////////////////////////////////
    // Column Chooser
    ////////////////////////////////////////
    .ag-column-select-panel {
        .ag-primary-cols-header-panel {
            border-top: 0;
            padding-left: $grid-size;

            & > div[ref='eSelect'] {
                margin-left: $grid-size * 2;
            }
        }

        .ag-primary-cols-list-panel {
            margin-left: $grid-size * 2;
            margin-right: $grid-size * 2;
            padding-left: 0;
        }

        .ag-primary-cols-header-panel {
            padding-top: $grid-size * 2;
            padding-bottom: $grid-size * 2;
            height: auto;

            .ag-checkbox {
                @include checkbox($active);
            }

            .ag-input-wrapper {
                margin-right: $grid-size * 2;
            }
        }

        .ag-primary-cols-list-panel .ag-checkbox input {
            @include checkbox($active);
        }

        .ag-primary-cols-list-panel > div {
            height: $grid-size * 5;
        }

        .ag-primary-cols-filter-wrapper.ag-input-wrapper {
            overflow: visible;
        }
        .ag-primary-cols-filter {
            @extend %input-box;
        }
    }

    ////////////////////////////////////////
    // Overlay
    ////////////////////////////////////////
    .ag-overlay-loading-center {
        box-shadow: 0 0 2px 0.1rem transparentize($alpine-gray-4, 0.6);
        border: 1px solid $alpine-gray-4;
        padding: $grid-size * 2 $grid-size * 3;
        font: $font-weight $font-size $font-family;
    }

    ////////////////////////////////////////
    // Grouping
    ////////////////////////////////////////
    .ag-group-checkbox input[type='checkbox'] {
        display: inline-block;
        vertical-align: middle;
        transform: translatey(-1px);
    }

    ////////////////////////////////////////
    // The below works great for grid-size = 4, but does not for larger one.
    ////////////////////////////////////////
    .ag-selection-checkbox:not(.ag-hidden),
    .ag-group-expanded:not(.ag-hidden),
    .ag-group-contracted:not(.ag-hidden),
    .ag-group-checkbox:not(.ag-invisible) {
        ~ .ag-cell-value,
        + .ag-group-value {
            &:not(:empty) {
                margin-left: $grid-size;
            }
        }
        ~ .ag-group-checkbox {
            margin-left: $grid-size;
        }
    }

    ////////////////////////////////////////
    // Group panel
    ////////////////////////////////////////

    .ag-column-drop-horizontal {
        // Align the first pill to the header
        font: $chrome-font-weight $chrome-font-size $chrome-font-family;
        .ag-icon-group {
            margin-right: $grid-size * 2;
        }
    }

    .ag-column-drop-cell {
        padding: 0;

        .ag-column-drag {
            margin-left: $grid-size;
            transform: translateY(4px);
        }

        .ag-column-drop-cell-text {
            transform: translateY(1px);
        }

        .ag-column-drop-cell-button {
            min-width: auto;
            transform: translateY(4px);
        }
    }
}
